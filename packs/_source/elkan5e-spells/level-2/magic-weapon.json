{
	"name": "Magic Weapon",
	"type": "spell",
	"img": "icons/magic/fire/dagger-rune-enchant-flame-blue.webp",
	"effects": [
		{
			"name": "Magic Weapon, +1",
			"flags": {
				"dnd5e": {
					"enchantment": {
						"level": {
							"min": null,
							"max": 3
						},
						"riders": {
							"effect": [],
							"item": []
						}
					}
				},
				"dae": {
					"disableIncapacitated": false,
					"selfTarget": false,
					"selfTargetAlways": false,
					"dontApply": false,
					"stackable": "noneName",
					"showIcon": false,
					"durationExpression": "",
					"macroRepeat": "none",
					"specialDuration": [],
					"enableCondition": "",
					"disableCondition": ""
				},
				"ActiveAuras": {
					"isAura": false,
					"aura": "None",
					"nameOverride": "",
					"radius": "",
					"alignment": "",
					"type": "",
					"customCheck": "",
					"ignoreSelf": false,
					"height": false,
					"hidden": false,
					"displayTemp": false,
					"hostile": false,
					"onlyOnce": false,
					"wallsBlock": "system"
				},
				"core": {
					"overlay": false
				}
			},
			"img": "icons/magic/fire/dagger-rune-enchant-flame-blue.webp",
			"_id": "rrLq0mbSeWoGhgYP",
			"type": "enchantment",
			"system": {},
			"changes": [
				{
					"key": "name",
					"mode": 5,
					"value": "{}, +1",
					"priority": 20
				},
				{
					"key": "system.properties",
					"mode": 2,
					"value": "mgc",
					"priority": 20
				},
				{
					"key": "system.magicalBonus",
					"mode": 5,
					"value": "1",
					"priority": 20
				}
			],
			"disabled": false,
			"duration": {
				"startTime": null,
				"seconds": 3600,
				"combat": null,
				"rounds": null,
				"turns": null,
				"startRound": null,
				"startTurn": null
			},
			"description": "",
			"origin": null,
			"tint": "#ffffff",
			"transfer": false,
			"statuses": [],
			"sort": 0,
			"_key": "!items.effects!t9uz8UUAhL7TnJkP.rrLq0mbSeWoGhgYP"
		},
		{
			"name": "Magic Weapon, +2",
			"flags": {
				"dnd5e": {
					"enchantment": {
						"level": {
							"min": 4,
							"max": 5
						},
						"riders": {
							"effect": [],
							"item": []
						}
					}
				},
				"dae": {
					"disableIncapacitated": false,
					"selfTarget": false,
					"selfTargetAlways": false,
					"dontApply": false,
					"stackable": "noneName",
					"showIcon": false,
					"durationExpression": "",
					"macroRepeat": "none",
					"specialDuration": []
				}
			},
			"img": "icons/magic/fire/dagger-rune-enchant-flame-blue.webp",
			"_id": "p4eY7khe1zudgEt5",
			"type": "enchantment",
			"system": {},
			"changes": [
				{
					"key": "name",
					"mode": 5,
					"value": "{}, +2",
					"priority": 20
				},
				{
					"key": "system.properties",
					"mode": 2,
					"value": "mgc",
					"priority": 20
				},
				{
					"key": "system.magicalBonus",
					"mode": 5,
					"value": "2",
					"priority": 20
				}
			],
			"disabled": false,
			"duration": {
				"startTime": null,
				"seconds": 3600,
				"combat": null,
				"rounds": null,
				"turns": null,
				"startRound": null,
				"startTurn": null
			},
			"description": "",
			"origin": null,
			"tint": "#ffffff",
			"transfer": false,
			"statuses": [],
			"sort": 0,
			"_key": "!items.effects!t9uz8UUAhL7TnJkP.p4eY7khe1zudgEt5"
		},
		{
			"name": "Magic Weapon, +3",
			"flags": {
				"dnd5e": {
					"enchantment": {
						"level": {
							"min": 6,
							"max": null
						},
						"riders": {
							"effect": [],
							"item": []
						}
					}
				},
				"dae": {
					"disableIncapacitated": false,
					"selfTarget": false,
					"selfTargetAlways": false,
					"dontApply": false,
					"stackable": "noneName",
					"showIcon": false,
					"durationExpression": "",
					"macroRepeat": "none",
					"specialDuration": []
				}
			},
			"img": "icons/magic/fire/dagger-rune-enchant-flame-blue.webp",
			"_id": "dFkTSCILL6KwE7IZ",
			"type": "enchantment",
			"system": {},
			"changes": [
				{
					"key": "name",
					"mode": 5,
					"value": "{}, +3",
					"priority": 20
				},
				{
					"key": "system.properties",
					"mode": 2,
					"value": "mgc",
					"priority": 20
				},
				{
					"key": "system.magicalBonus",
					"mode": 5,
					"value": "3",
					"priority": 20
				}
			],
			"disabled": false,
			"duration": {
				"startTime": null,
				"seconds": 3600,
				"combat": null,
				"rounds": null,
				"turns": null,
				"startRound": null,
				"startTurn": null
			},
			"description": "",
			"origin": null,
			"tint": "#ffffff",
			"transfer": false,
			"statuses": [],
			"sort": 0,
			"_key": "!items.effects!t9uz8UUAhL7TnJkP.dFkTSCILL6KwE7IZ"
		}
	],
	"folder": "6J3i75lfD1J0xYwA",
	"flags": {
		"dynamiceffects": {
			"equipActive": true,
			"alwaysActive": false,
			"effects": [
				{
					"modSpecKey": "macro.execute",
					"value": "\"Magic Weapon\" @target @item.level",
					"mode": "+",
					"targetSpecific": false,
					"id": 1,
					"itemId": "f1nQIsVPzwoUTqOt",
					"active": true,
					"_targets": []
				}
			]
		},
		"itemacro": {
			"macro": {
				"_data": {
					"name": "Magic Weapon",
					"type": "script",
					"scope": "global",
					"command": "//DAE Item Macro Execute, arguments = @item.level\nconst lastArg = args[args.length - 1];\nlet tactor;\nif (lastArg.tokenId) tactor = canvas.tokens.get(lastArg.tokenId).actor;\nelse tactor = game.actors.get(lastArg.actorId);\nconst DAEItem = lastArg.efData.flags.dae.itemData\n\nlet weapons = tactor.items.filter(i => i.data.type === `weapon`);\nlet weapon_content = ``;\n\nfunction value_limit(val, min, max) {\n    return val < min ? min : (val > max ? max : val);\n};\n//Filter for weapons\nfor (let weapon of weapons) {\n    weapon_content += `<label class=\"radio-label\">\n    <input type=\"radio\" name=\"weapon\" value=\"${weapon.id}\">\n    <img src=\"${weapon.img}\" style=\"border:0px; width: 50px; height:50px;\">\n    ${weapon.data.name}\n  </label>`;\n}\n\n/**\n * Select for weapon and apply bonus based on spell level\n */\nif (args[0] === \"on\") {\n    let content = `\n    <style>\n    .magicWeapon .form-group {\n        display: flex;\n        flex-wrap: wrap;\n        width: 100%;\n        align-items: flex-start;\n      }\n      \n      .magicWeapon .radio-label {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        text-align: center;\n        justify-items: center;\n        flex: 1 0 25%;\n        line-height: normal;\n      }\n      \n      .magicWeapon .radio-label input {\n        display: none;\n      }\n      \n      .magicWeapon img {\n        border: 0px;\n        width: 50px;\n        height: 50px;\n        flex: 0 0 50px;\n        cursor: pointer;\n      }\n          \n      /* CHECKED STYLES */\n      .magicWeapon [type=radio]:checked + img {\n        outline: 2px solid #f00;\n      }\n    </style>\n    <form class=\"magicWeapon\">\n      <div class=\"form-group\" id=\"weapons\">\n          ${weapon_content}\n      </div>\n    </form>\n    `;\n\n    new Dialog({\n        content,\n        buttons:\n        {\n            Ok:\n            {\n                label: `Ok`,\n                callback: (html) => {\n                    let itemId = $(\"input[type='radio'][name='weapon']:checked\").val();\n                    let weaponItem = tactor.items.get(itemId);\n                    let copy_item = duplicate(weaponItem);\n                    let spellLevel = Math.floor(DAEItem.data.level / 2);\n                    let bonus = value_limit(spellLevel, 1, 3);\n                    let wpDamage = copy_item.data.damage.parts[0][0];\n                    let verDamage = copy_item.data.damage.versatile;\n                    DAE.setFlag(tactor, `magicWeapon`, {\n                        damage: weaponItem.data.data.attackBonus,\n                        weapon: itemId,\n                        weaponDmg: wpDamage,\n                        verDmg: verDamage,\n                        mgc : copy_item.data.properties.mgc\n                    }\n                    );\n                    if(copy_item.data.attackBonus === \"\") copy_item.data.attackBonus = \"0\"\n                    copy_item.data.attackBonus = `${parseInt(copy_item.data.attackBonus) + bonus}`;\n                    copy_item.data.damage.parts[0][0] = (wpDamage + \" + \" + bonus);\n                    copy_item.data.properties.mgc = true\n                    if (verDamage !== \"\" && verDamage !== null) copy_item.data.damage.versatile = (verDamage + \" + \" + bonus);\n                    tactor.updateEmbeddedEntity(\"OwnedItem\", copy_item);\n                }\n            },\n            Cancel:\n            {\n                label: `Cancel`\n            }\n        }\n    }).render(true);\n}\n\n//Revert weapon and unset flag.\nif (args[0] === \"off\") {\n    let { damage, weapon, weaponDmg, verDmg, mgc} = DAE.getFlag(tactor, 'magicWeapon');\n    let weaponItem = tactor.items.get(weapon);\n    let copy_item = duplicate(weaponItem);\n    copy_item.data.attackBonus = damage;\n    copy_item.data.damage.parts[0][0] = weaponDmg;\n    copy_item.data.properties.mgc = mgc\n    if (verDmg !== \"\" && verDmg !== null) copy_item.data.damage.versatile = verDmg;\n    tactor.updateEmbeddedEntity(\"OwnedItem\", copy_item);\n    DAE.unsetFlag(tactor, `magicWeapon`);\n}",
					"author": "E4BVikjIkVl2lL2j"
				},
				"data": {
					"name": "Magic Weapon",
					"type": "script",
					"scope": "global",
					"command": "//DAE Item Macro Execute, arguments = @item.level\nif (!game.modules.get(\"advanced-macros\")?.active) {ui.notifications.error(\"Please enable the Advanced Macros module\") ;return;}\n\nconst lastArg = args[args.length - 1];\nlet tactor;\nif (lastArg.tokenId) tactor = canvas.tokens.get(lastArg.tokenId).actor;\nelse tactor = game.actors.get(lastArg.actorId);\nconst DAEItem = lastArg.efData.flags.dae.itemData\n\nlet weapons = tactor.items.filter(i => i.data.type === `weapon`);\nlet weapon_content = ``;\n\nfunction value_limit(val, min, max) {\n    return val < min ? min : (val > max ? max : val);\n};\n//Filter for weapons\nfor (let weapon of weapons) {\n    weapon_content += `<label class=\"radio-label\">\n    <input type=\"radio\" name=\"weapon\" value=\"${weapon.id}\">\n    <img src=\"${weapon.img}\" style=\"border:0px; width: 50px; height:50px;\">\n    ${weapon.data.name}\n  </label>`;\n}\n\n/**\n * Select for weapon and apply bonus based on spell level\n */\nif (args[0] === \"on\") {\n    let content = `\n    <style>\n    .magicWeapon .form-group {\n        display: flex;\n        flex-wrap: wrap;\n        width: 100%;\n        align-items: flex-start;\n      }\n      \n      .magicWeapon .radio-label {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        text-align: center;\n        justify-items: center;\n        flex: 1 0 25%;\n        line-height: normal;\n      }\n      \n      .magicWeapon .radio-label input {\n        display: none;\n      }\n      \n      .magicWeapon img {\n        border: 0px;\n        width: 50px;\n        height: 50px;\n        flex: 0 0 50px;\n        cursor: pointer;\n      }\n          \n      /* CHECKED STYLES */\n      .magicWeapon [type=radio]:checked + img {\n        outline: 2px solid #f00;\n      }\n    </style>\n    <form class=\"magicWeapon\">\n      <div class=\"form-group\" id=\"weapons\">\n          ${weapon_content}\n      </div>\n    </form>\n    `;\n\n    new Dialog({\n        content,\n        buttons:\n        {\n            Ok:\n            {\n                label: `Ok`,\n                callback: (html) => {\n                    let itemId = $(\"input[type='radio'][name='weapon']:checked\").val();\n                    let weaponItem = tactor.items.get(itemId);\n                    let copy_item = duplicate(weaponItem);\n                    let spellLevel = Math.floor(DAEItem.data.level / 2);\n                    let bonus = value_limit(spellLevel, 1, 3);\n                    let wpDamage = copy_item.data.damage.parts[0][0];\n                    let verDamage = copy_item.data.damage.versatile;\n                    DAE.setFlag(tactor, `magicWeapon`, {\n                        damage: weaponItem.data.data.attackBonus,\n                        weapon: itemId,\n                        weaponDmg: wpDamage,\n                        verDmg: verDamage,\n                        mgc : copy_item.data.properties.mgc\n                    }\n                    );\n                    if(copy_item.data.attackBonus === \"\") copy_item.data.attackBonus = \"0\"\n                    copy_item.data.attackBonus = `${parseInt(copy_item.data.attackBonus) + bonus}`;\n                    copy_item.data.damage.parts[0][0] = (wpDamage + \" + \" + bonus);\n                    copy_item.data.properties.mgc = true\n                    if (verDamage !== \"\" && verDamage !== null) copy_item.data.damage.versatile = (verDamage + \" + \" + bonus);\n                    tactor.updateEmbeddedDocuments(\"Item\", [copy_item]);\n                }\n            },\n            Cancel:\n            {\n                label: `Cancel`\n            }\n        }\n    }).render(true);\n}\n\n//Revert weapon and unset flag.\nif (args[0] === \"off\") {\n    let { damage, weapon, weaponDmg, verDmg, mgc} = DAE.getFlag(tactor, 'magicWeapon');\n    let weaponItem = tactor.items.get(weapon);\n    let copy_item = duplicate(weaponItem);\n    copy_item.data.attackBonus = damage;\n    copy_item.data.damage.parts[0][0] = weaponDmg;\n    copy_item.data.properties.mgc = mgc\n    if (verDmg !== \"\" && verDmg !== null) copy_item.data.damage.versatile = verDmg;\n    tactor.updateEmbeddedDocuments(\"Item\", [copy_item]);\n    DAE.unsetFlag(tactor, `magicWeapon`);\n}",
					"author": "zrPR3wueYsESSBR3",
					"_id": null,
					"img": "icons/svg/dice-target.svg",
					"folder": null,
					"sort": 0,
					"permission": {
						"default": 0
					},
					"flags": {}
				},
				"options": {},
				"apps": {},
				"compendium": null
			}
		},
		"dae": {
			"activeEquipped": false,
			"alwaysActive": false,
			"macro": {
				"name": "Magic Weapon",
				"img": "icons/magic/fire/dagger-rune-enchant-flame-blue.webp",
				"type": "script",
				"scope": "global",
				"command": "",
				"author": "vHqSHJMdmEO6Mk2C",
				"ownership": {
					"default": 3
				},
				"_id": null,
				"folder": null,
				"sort": 0,
				"flags": {},
				"_stats": {
					"coreVersion": "12.324",
					"systemId": "dnd5e",
					"systemVersion": "3.2.0",
					"createdTime": null,
					"modifiedTime": null,
					"lastModifiedBy": null,
					"compendiumSource": null,
					"duplicateSource": null
				}
			}
		},
		"midi-qol": {
			"onUseMacroName": "",
			"effectActivation": false,
			"itemCondition": "",
			"reactionCondition": "",
			"otherCondition": "",
			"effectCondition": "",
			"rollAttackPerTarget": "default",
			"removeAttackDamageButtons": "default"
		},
		"core": {},
		"midiProperties": {
			"nodam": false,
			"fulldam": false,
			"halfdam": false,
			"rollOther": false,
			"critOther": false,
			"magicdam": false,
			"magiceffect": false,
			"concentration": false,
			"toggleEffect": false,
			"autoFailFriendly": false,
			"autoSaveFriendly": false,
			"offHandWeapon": false,
			"ignoreTotalCover": false,
			"confirmTargets": "default",
			"noConcentrationCheck": false,
			"idr": false,
			"idi": false,
			"idv": false,
			"ida": false
		},
		"dnd5e": {
			"riders": {
				"activity": [],
				"effect": []
			},
			"migratedProperties": [
				"vocal",
				"somatic",
				"concentration"
			]
		},
		"tidy5e-sheet": {
			"section": "",
			"actionSection": ""
		}
	},
	"system": {
		"description": {
			"value": "<p><em>You touch a weapon, instilling your magic into it so that it may strike faster and harder than before, piercing magical defenses.</em></p><p><strong>Enchant Item</strong></p><p>The chosen weapon becomes a &amp;reference[magic weapon] weapon if it wasn't already, with a +1 bonus to attack rolls and damage rolls* if it didn't already have at least a +1 bonus.</p><p></p><p><strong>*Upcasting:</strong> At spell level 4 or 5, the bonus to attack and damage becomes +2 if not already higher, and at spell level 6 or higher, the bonus becomes +3.</p>",
			"chat": "<p><strong>Enchant Item</strong></p><p>The chosen weapon becomes a &amp;reference[magic weapon] weapon if it wasn't already, with a +1 bonus to attack rolls and damage rolls* if it didn't already have at least a +1 bonus.</p><p></p><p><strong>*Upcasting:</strong> At spell level 4 or 5, the bonus to attack and damage becomes +2 if not already higher, and at spell level 6 or higher, the bonus becomes +3.</p>"
		},
		"source": {
			"custom": "elkan5e.com/spells/magic-weapon",
			"revision": 1,
			"rules": "",
			"book": "Elkan 5e",
			"page": "",
			"license": ""
		},
		"activation": {
			"type": "bonus",
			"condition": "",
			"value": 1
		},
		"duration": {
			"value": "8",
			"units": "hour"
		},
		"target": {
			"affects": {
				"type": "object",
				"count": "1",
				"choice": false,
				"special": ""
			},
			"template": {
				"units": "",
				"contiguous": false,
				"type": ""
			}
		},
		"range": {
			"units": "touch",
			"special": ""
		},
		"uses": {
			"max": "",
			"recovery": [],
			"spent": 0
		},
		"ability": "",
		"level": 2,
		"school": "trs",
		"materials": {
			"value": "",
			"consumed": false,
			"cost": 0,
			"supply": 0
		},
		"preparation": {
			"mode": "prepared",
			"prepared": true
		},
		"properties": [
			"vocal",
			"somatic",
			"mgc"
		],
		"activities": {
			"dnd5eactivity000": {
				"_id": "dnd5eactivity000",
				"type": "enchant",
				"activation": {
					"type": "action",
					"value": null,
					"override": false
				},
				"consumption": {
					"targets": [],
					"scaling": {
						"allowed": false,
						"max": ""
					},
					"spellSlot": true
				},
				"description": {
					"chatFlavor": ""
				},
				"duration": {
					"units": "inst",
					"concentration": false,
					"override": false
				},
				"effects": [
					{
						"_id": "rrLq0mbSeWoGhgYP",
						"level": {
							"min": null,
							"max": 3
						},
						"riders": {
							"effect": [],
							"item": [],
							"activity": []
						}
					},
					{
						"_id": "p4eY7khe1zudgEt5",
						"level": {
							"min": 4,
							"max": 5
						},
						"riders": {
							"effect": [],
							"item": [],
							"activity": []
						}
					},
					{
						"_id": "dFkTSCILL6KwE7IZ",
						"level": {
							"min": 6,
							"max": null
						},
						"riders": {
							"effect": [],
							"item": [],
							"activity": []
						}
					}
				],
				"range": {
					"override": false
				},
				"target": {
					"type": "creature",
					"value": 1,
					"units": "ft",
					"width": null,
					"override": false,
					"prompt": true
				},
				"uses": {
					"spent": 0,
					"max": "",
					"recovery": []
				},
				"enchant": {
					"identifier": ""
				},
				"restrictions": {
					"allowMagical": false,
					"type": "weapon",
					"categories": [],
					"properties": []
				},
				"sort": 0
			}
		},
		"identifier": ""
	},
	"_id": "t9uz8UUAhL7TnJkP",
	"_key": "!items!t9uz8UUAhL7TnJkP"
}