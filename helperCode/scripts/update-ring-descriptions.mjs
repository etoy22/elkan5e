import fs from "node:fs";
import path from "node:path";

const base = path.join(process.cwd(), "packs/_source/elkan5e-magic-items/srd-items-not-finished-converting/rings");

const updates = {
	"ring-of-shooting-stars.json": `<p><em>Ring - Very Rare (Requires Attunement)</em></p><p><strong>Buff</strong></p><ul><li><p>You can cast <em>Dancing Lights</em> or <em>Light</em> from the ring.</p></li></ul><p><strong>Activation</strong></p><ul><li><p>6 Charges (Regains 1d6 Charges at Dawn). While wearing the ring you can expend charges to use the following options (save DC 15):</p><ul><li><p>Action (1 Charge) - Cast <em>@UUID[Compendium.elkan5e.elkan5e-spells.Item.xxhReFO5bBzylMmY]{Faerie Fire}</em>.</p></li><li><p>Action (2 Charges) - Create up to four 3-foot-diameter spheres of lightning in unoccupied spaces you can see within 120 feet. The spheres last while you maintain Concentration (up to 1 minute), shed Dim Light in a 30-foot radius, and each can move 30 feet (maximum 120 feet from you) as a Bonus Action. The first time a sphere comes within 5 feet of a creature other than you that isn't behind &amp;Reference[Total Cover apply=false], it discharges and disappears. That creature makes a [[/save DEX 15]]{DC 15 Dexterity saving throw}, taking Lightning damage based on the number of spheres created (see table) on a failure or half as much on a success.</p><table><thead><tr><th> Number of Spheres </th><th>Lightning Damage</th></tr></thead><tbody><tr><td>1</td><td>[[/damage 4d12 lightning]]</td></tr><tr><td>2</td><td>[[/damage 5d4 lightning]]</td></tr><tr><td>3</td><td>[[/damage 2d6 lightning]]</td></tr><tr><td>4</td><td>[[/damage 2d4 lightning]]</td></tr></tbody></table></li><li><p>Action (1-3 Charges) - Launch one glowing mote per charge at a point you can see within 60 feet. Each creature in a 15-foot Cube originating from that point makes a [[/save DEX 15]]{DC 15 Dexterity saving throw}, taking 5d4 Radiant damage on a failed save or half as much on a success.</p></li></ul></li></ul><section id="foundry-secret-1" class="secret"><p><strong>Foundry Note</strong></p><p>The <strong>Create Lightning Spheres</strong> and <strong>Shooting Stars</strong> activities allow you to select the number of spheres/motes you would like to create and place a measured template for each one.</p></section>`,
	"ring-of-spell-storing.json": `<p><em>Ring - Rare (Requires Attunement)</em></p><p><strong>Buff</strong></p><ul><li><p>This ring stores spells cast into it, holding them until the attuned wearer uses them. The ring can store up to 5 levels worth of spells at a time. When found, it contains [[/r 1d6 - 1]] levels of stored spells chosen by the GM.</p></li><li><p>Any creature can cast a spell of level 1 through 5 into the ring by touching the ring as the spell is cast. The spell has no effect other than to be stored in the ring. If the ring can't hold the spell, the spell is expended without effect. The level of the slot used to cast the spell determines how much space it uses.</p></li><li><p>While wearing this ring, you can cast any spell stored in it. The spell uses the slot level, spell save DC, spell attack bonus, and spellcasting ability of the original caster but is otherwise treated as if you cast the spell. The spell cast from the ring is no longer stored in it, freeing up space.</p></li></ul><section id="foundry-secret-1" class="secret"><p><strong>Foundry Note</strong></p><p>To store a spell in this ring, drag the spell onto the Activities tab to create a "Cast a Spell" activity. Then change to the "Spell" tab, set the "Casting Level", check the "Override Values" box and enter the relevant Attack Bonus and Save DC from the original caster's values. You will then be able to cast that spell from this ring without expending your own slots. You will then need to delete the activity since each spell is a one-time use.</p></section>`,
	"ring-of-spell-turning.json": `<p><em>Ring - Legendary (Requires Attunement)</em></p><p><strong>Reaction</strong></p><ul><li><p>While wearing this ring, you have Advantage on saving throws against spells. If you succeed on the save for a spell of level 7 or lower, the spell has no effect on you. If that spell targeted only you and didn't create an area of effect, you can take a Reaction to deflect the spell back at the spell's caster; the caster must make a saving throw against the spell using their own spell save DC.</p></li></ul>`,
	"ring-of-telekinesis.json": `<p><em>Ring - Very Rare (Requires Attunement)</em></p><p><strong>Action</strong></p><ul><li><p>While wearing this ring, you can cast <em>@UUID[Compendium.elkan5e.elkan5e-spells.Item.EihC0prUS7NZDdtL]{Telekinesis}</em> from it.</p></li></ul>`,
	"ring-of-the-ram.json": `<p><em>Ring - Rare (Requires Attunement)</em></p><p><strong>Activation</strong></p><ul><li><p>3 Charges (Regains 1d3 Charges at Dawn). While wearing the ring, you can expend charges to use the following options:</p><ul><li><p>Action (1-3 Charges) - Make a ranged spell attack (bonus +7) against one creature you can see within 60 feet. On a hit, the target takes 2d10 Force damage per charge spent and is pushed 5 feet away from you for each charge spent.</p></li><li><p>Action (1-3 Charges) - Target a nonmagical object you can see within 60 feet that isn't being worn or carried. The ring makes a Strength check with a +5 bonus per charge spent to break the object.</p></li></ul></li></ul>`,
	"ring-of-three-wishes.json": `<p><em>Ring - Legendary</em></p><p><strong>Action</strong></p><ul><li><p>While wearing this ring, you can expend 1 of its 3 charges to cast <em>@UUID[Compendium.elkan5e.elkan5e-spells.Item.5e0swEflzMmSszQ0]{Wish}</em> from it. The ring becomes nonmagical when you use the last charge.</p></li></ul>`,
	"ring-of-x-ray-vision.json": `<p><em>Ring - Rare (Requires Attunement)</em></p><p><strong>Action</strong></p><ul><li><p>While wearing this ring, you can take an Action to gain X-ray vision with a range of 30 feet for 1 minute. To you, solid objects within that radius appear transparent and don't prevent light from passing through them. The vision can penetrate 1 foot of stone, 1 inch of common metal, or up to 3 feet of wood or dirt. Thicker substances or a thin sheet of lead block the vision. Whenever you use the ring again before taking a Long Rest, you must succeed on a [[/save CON 15]]{DC 15 Constitution saving throw} or gain 1 &amp;Reference[Exhaustion] level.</p></li></ul>`
};

let updated = 0;

for (const [file, value] of Object.entries(updates)) {
	const filePath = path.join(base, file);
	const raw = fs.readFileSync(filePath, "utf8");
	const data = JSON.parse(raw);
	if (data?.system?.description?.value === value) continue;
	data.system.description.value = value;
	fs.writeFileSync(filePath, JSON.stringify(data, null, "\t") + "\n");
	updated++;
}

console.log(`Updated descriptions in ${updated} ring files.`);

